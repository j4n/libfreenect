#!/usr/bin/make -f
# -*- makefile -*-

DEB_LDFLAGS_MAINT_APPEND=-Wl,-Bsymbolic-functions -Wl,--as-needed
include /usr/share/dpkg/buildflags.mk
export CFLAGS CPPFLAGS LDFLAGS

%:
	dh $@

override_dh_auto_configure:
	dh_auto_configure -- -DBUILD_PYTHON:Bool=True

override_dh_auto_build-indep:
ifeq (,$(filter nodoc,$(DEB_BUILD_OPTIONS)))
	doxygen debian/doxygen.conf
else
	: # Documentation was not built due to nodoc flag in DEB_BUILD_OPTIONS
	: # Creating dummy blank debian/html expected by -doc package
	mkdir -p debian/html
endif

override_dh_auto_install:
	dh_auto_install
	mv debian/tmp/usr/bin/glview debian/tmp/usr/bin/freenect-glview
	mv debian/tmp/usr/bin/glpclview debian/tmp/usr/bin/freenect-glpclview
	mv debian/tmp/usr/bin/cppview debian/tmp/usr/bin/freenect-cppview

override_dh_pysupport:
	dh_pysupport -ppython-freenect
	dh_numpy -ppython-freenect

override_dh_installdocs:
	dh_installdocs --all CONTRIB

override_dh_clean-indep:
	rm -rf debian/html
